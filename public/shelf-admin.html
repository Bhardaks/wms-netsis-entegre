<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, maximum-scale=1.0" />
  <title>Raf Y√∂netimi</title>
  <link rel="stylesheet" href="/assets/css/styles.css" />
  <link rel="stylesheet" href="/assets/css/zebra-terminal.css" />
  <script src="/assets/js/auth.js"></script>
</head>
<body>
<header>
  <div class="header-brand">
    <h1>WMS Y√∂netim Sistemi</h1>
    <span class="header-subtitle">Raf Y√∂netimi</span>
  </div>
  <div class="header-actions">
    <a href="/index.html" class="home-btn">
      <span class="home-icon">üè†</span>
      <span class="home-text">Ana Sayfa</span>
    </a>
  </div>
</header>

<main class="grid" style="max-width:1400px;margin:auto;padding:16px">

  <!-- Raf Ekleme Formu -->
  <section class="card user-friendly-form">
    <div class="form-header">
      <h2>üèóÔ∏è Yeni Raf Olu≈ütur</h2>
      <p class="form-description">Depo rafƒ±nƒ±zƒ± sisteme eklemek i√ßin a≈üaƒüƒ±daki bilgileri doldurun</p>
    </div>
    
    <form id="shelfForm">
      <div class="form-container">
        <!-- Temel Bilgiler -->
        <div class="form-section">
          <h3 class="section-title">üìã Temel Bilgiler</h3>
          <div class="form-row">
            <div class="form-group full-width">
              <label for="shelfName">
                <span class="label-icon">üè∑Ô∏è</span>
                Raf Adƒ± *
              </label>
              <input type="text" id="shelfName" name="shelf_name" required maxlength="100" 
                     placeholder="√ñrn: Ana Depo A1-01 Seviye 1" class="modern-input">
              <small class="help-text">Rafƒ±nƒ±z i√ßin kolay hatƒ±rlanƒ±r bir isim girin</small>
            </div>
          </div>
        </div>

        <!-- Konum Bilgileri -->
        <div class="form-section">
          <h3 class="section-title">üìç Konum Bilgileri</h3>
          <div class="input-mode-toggle">
            <button type="button" id="selectMode" class="toggle-btn active">Se√ßim Modu</button>
            <button type="button" id="manualMode" class="toggle-btn">Manuel Giri≈ü</button>
          </div>
          
          <div class="form-row">
            <!-- Se√ßim Modu -->
            <div id="selectionInputs" class="selection-inputs">
              <div class="form-group">
                <label for="zone">
                  <span class="label-icon">üè¢</span>
                  B√∂lge *
                </label>
                <select id="zone" name="zone" required class="modern-select">
                  <option value="">B√∂lge Se√ßin</option>
                  <option value="A">A B√∂lgesi</option>
                  <option value="B">B B√∂lgesi</option>
                  <option value="C">C B√∂lgesi</option>
                  <option value="D">D B√∂lgesi</option>
                  <option value="RETURN">ƒ∞ade Alanƒ±</option>
                  <option value="QUARANTINE">Karantina</option>
                  <option value="CUSTOM">√ñzel</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="aisle">
                  <span class="label-icon">üõ§Ô∏è</span>
                  Koridor *
                </label>
                <select id="aisle" name="aisle" required class="modern-select">
                  <option value="">Koridor Se√ßin</option>
                  <option value="1">1. Koridor</option>
                  <option value="2">2. Koridor</option>
                  <option value="3">3. Koridor</option>
                  <option value="4">4. Koridor</option>
                  <option value="5">5. Koridor</option>
                  <option value="CUSTOM">√ñzel</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="level">
                  <span class="label-icon">üìè</span>
                  Seviye *
                </label>
                <select id="level" name="level" required class="modern-select">
                  <option value="">Seviye Se√ßin</option>
                  <option value="1">Seviye 1 (Zemin)</option>
                  <option value="2">Seviye 2 (Orta)</option>
                  <option value="3">Seviye 3 (√úst)</option>
                  <option value="4">Seviye 4</option>
                  <option value="5">Seviye 5</option>
                  <option value="CUSTOM">√ñzel</option>
                </select>
              </div>
            </div>

            <!-- Manuel Giri≈ü Modu -->
            <div id="manualInputs" class="manual-inputs" style="display: none;">
              <div class="form-group">
                <label for="manualZone">
                  <span class="label-icon">üè¢</span>
                  B√∂lge Kodu *
                </label>
                <input type="text" id="manualZone" placeholder="√ñrn: A, B1, OZEL" class="modern-input" maxlength="20">
                <small class="help-text">B√∂lge kodunu manuel olarak girin</small>
              </div>
              
              <div class="form-group">
                <label for="manualAisle">
                  <span class="label-icon">üõ§Ô∏è</span>
                  Koridor *
                </label>
                <input type="text" id="manualAisle" placeholder="√ñrn: 1, A1, 01" class="modern-input" maxlength="10">
                <small class="help-text">Koridor numarasƒ±nƒ± girin</small>
              </div>
              
              <div class="form-group">
                <label for="manualLevel">
                  <span class="label-icon">üìè</span>
                  Seviye *
                </label>
                <input type="text" id="manualLevel" placeholder="√ñrn: 1, A, YER" class="modern-input" maxlength="10">
                <small class="help-text">Seviye bilgisini girin</small>
              </div>
            </div>
          </div>
        </div>

        <!-- Kapasite ve Barkod -->
        <div class="form-section">
          <h3 class="section-title">‚öôÔ∏è Raf Ayarlarƒ±</h3>
          <div class="form-row">
            <div class="form-group">
              <label for="capacity">
                <span class="label-icon">üì¶</span>
                Kapasite
              </label>
              <input type="number" id="capacity" name="capacity" value="100" min="1" max="10000" class="modern-input">
              <small class="help-text">Maksimum paket kapasitesi</small>
            </div>
            
            <div class="form-group">
              <label for="generatedBarcode">
                <span class="label-icon">üè∑Ô∏è</span>
                Raf Barkodu
              </label>
              <div class="barcode-container">
                <input type="text" id="generatedBarcode" name="shelf_code" class="modern-input barcode-input" 
                       placeholder="Otomatik olu≈üturulacak" readonly>
                <div class="barcode-actions">
                  <button type="button" onclick="regenerateBarcode()" class="btn btn-outline">
                    üîÑ Yenile
                  </button>
                  <button type="button" onclick="toggleManualBarcode()" class="btn btn-outline" id="manualBarcodeToggle">
                    ‚úèÔ∏è Manuel
                  </button>
                </div>
              </div>
              <small class="help-text">Sistem otomatik barkod √ºretir veya manuel girebilirsiniz</small>
            </div>
          </div>
        </div>
      </div>
      
      <div class="form-actions modern-actions">
        <button type="button" onclick="clearForm()" class="btn btn-secondary">
          üóëÔ∏è Temizle
        </button>
        <button type="submit" class="btn btn-primary">
          üíæ Rafƒ± Olu≈ütur
        </button>
      </div>
    </form>
  </section>

  <!-- Raf Listesi -->
  <section class="card">
    <h2>üìã Mevcut Raflar (<span id="shelfCount">0</span> raf)</h2>
    
    <div class="filters-row">
      <select id="zoneFilter">
        <option value="">T√ºm B√∂lgeler</option>
      </select>
      <input id="searchInput" placeholder="Raf kodu, raf adƒ± ara...">
      <button onclick="loadShelves()" class="btn btn-primary">üîÑ Yenile</button>
    </div>
    
    <div class="table-container">
      <table id="shelvesTable">
        <thead>
          <tr>
            <th>Raf Barkodu</th>
            <th>Raf Adƒ±</th>
            <th>B√∂lge</th>
            <th>Konum</th>
            <th>Kapasite</th>
            <th>ƒ∞≈ülemler</th>
          </tr>
        </thead>
        <tbody id="shelvesTableBody">
        </tbody>
      </table>
    </div>
    
    <div class="loading" id="loading" style="display:none">
      Raflar y√ºkleniyor...
    </div>
    
    <div class="empty-state" id="emptyState" style="display:none">
      <div class="empty-icon">üì≠</div>
      <div class="empty-text">Hen√ºz raf eklenmemi≈ü</div>
    </div>
  </section>

</main>

<script>
let allShelves = [];
let filteredShelves = [];
let isManualMode = false;
let isManualBarcode = false;

document.addEventListener('DOMContentLoaded', function() {
    console.log('‚úÖ Raf Y√∂netimi sayfasƒ± y√ºklendi');
    
    // Mobile navigation functionality
    const mobileNavToggle = document.getElementById('mobileNavToggle');
    const mobileNavMenu = document.getElementById('mobileNavMenu');
    
    if (mobileNavToggle && mobileNavMenu) {
        mobileNavToggle.addEventListener('click', function() {
            mobileNavMenu.classList.toggle('show');
        });
        
        // Close mobile menu when clicking outside
        document.addEventListener('click', function(e) {
            if (!mobileNavToggle.contains(e.target) && !mobileNavMenu.contains(e.target)) {
                mobileNavMenu.classList.remove('show');
            }
        });
    }
    
    // Load shelf management functionality
    loadShelves();
    setupEventListeners();
});

function setupEventListeners() {
    document.getElementById('shelfForm').addEventListener('submit', saveShelf);
    document.getElementById('zone').addEventListener('change', generateBarcode);
    document.getElementById('aisle').addEventListener('change', generateBarcode);
    document.getElementById('level').addEventListener('change', generateBarcode);
    document.getElementById('zoneFilter').addEventListener('change', filterShelves);
    document.getElementById('searchInput').addEventListener('input', debounce(filterShelves, 300));
    
    // Modern form functionality
    setupModernFormFeatures();
    
    // Initial barcode generation
    generateBarcode();
}

function setupModernFormFeatures() {
    // Input mode toggle
    document.getElementById('selectMode').addEventListener('click', () => switchInputMode(false));
    document.getElementById('manualMode').addEventListener('click', () => switchInputMode(true));
    
    // Manual inputs event listeners
    document.getElementById('manualZone').addEventListener('input', handleManualInput);
    document.getElementById('manualAisle').addEventListener('input', handleManualInput);
    document.getElementById('manualLevel').addEventListener('input', handleManualInput);
    
    // Custom option handling
    document.getElementById('zone').addEventListener('change', handleCustomOption);
    document.getElementById('aisle').addEventListener('change', handleCustomOption);
    document.getElementById('level').addEventListener('change', handleCustomOption);
}

function generateBarcode() {
    // Manuel barkod modunda otomatik olu≈üturma yapma
    if (isManualBarcode) {
        return;
    }
    
    let zone, aisle, level;
    
    if (isManualMode) {
        zone = document.getElementById('manualZone').value.trim().toUpperCase();
        aisle = document.getElementById('manualAisle').value.trim().toUpperCase();
        level = document.getElementById('manualLevel').value.trim().toUpperCase();
    } else {
        zone = document.getElementById('zone').value;
        aisle = document.getElementById('aisle').value;
        level = document.getElementById('level').value;
    }
    
    if (zone && aisle && level) {
        const timestamp = Date.now().toString().slice(-4);
        const aisleFormatted = isManualMode ? aisle : aisle.toString().padStart(2, '0');
        const levelFormatted = isManualMode ? level : level.toString().padStart(2, '0');
        const barcode = zone + aisleFormatted + '-' + levelFormatted + '-' + timestamp;
        document.getElementById('generatedBarcode').value = barcode;
        console.log('üè∑Ô∏è Barkod olu≈üturuldu:', barcode);
    } else {
        document.getElementById('generatedBarcode').value = '';
        console.log('‚ö†Ô∏è Barkod olu≈üturulamadƒ± - eksik alanlar:', {zone, aisle, level});
    }
}

function regenerateBarcode() {
    generateBarcode();
}

function clearForm() {
    document.getElementById('shelfForm').reset();
    document.getElementById('generatedBarcode').value = '';
    
    // Clear manual inputs
    document.getElementById('manualZone').value = '';
    document.getElementById('manualAisle').value = '';
    document.getElementById('manualLevel').value = '';
    
    // Reset to selection mode
    switchInputMode(false);
    
    // Reset barcode mode
    if (isManualBarcode) {
        toggleManualBarcode();
    }
}

async function loadShelves() {
    try {
        document.getElementById('loading').style.display = 'block';
        
        const response = await fetch('/api/shelves');
        const data = await response.json();
        
        allShelves = data.shelves || [];
        populateZoneFilter();
        filterShelves();
        
    } catch (error) {
        console.error('Raf y√ºkleme hatasƒ±:', error);
        showError('Raflar y√ºklenirken hata olu≈ütu');
    } finally {
        document.getElementById('loading').style.display = 'none';
    }
}

function populateZoneFilter() {
    const zones = [...new Set(allShelves.map(s => s.zone))].filter(Boolean).sort();
    const zoneFilter = document.getElementById('zoneFilter');
    
    zoneFilter.innerHTML = '<option value="">T√ºm B√∂lgeler</option>' + 
        zones.map(zone => '<option value="' + zone + '">' + zone + ' B√∂lgesi</option>').join('');
}

function filterShelves() {
    const zoneValue = document.getElementById('zoneFilter').value;
    const searchValue = document.getElementById('searchInput').value.toLowerCase();
    
    filteredShelves = allShelves.filter(shelf => {
        if (zoneValue && shelf.zone !== zoneValue) return false;
        
        if (searchValue) {
            const searchText = (shelf.shelf_code + ' ' + shelf.shelf_name).toLowerCase();
            if (!searchText.includes(searchValue)) return false;
        }
        
        return true;
    });
    
    displayShelves(filteredShelves);
}

function displayShelves(shelves) {
    document.getElementById('shelfCount').textContent = shelves.length;
    const tbody = document.getElementById('shelvesTableBody');
    
    if (shelves.length === 0) {
        tbody.innerHTML = '';
        document.getElementById('emptyState').style.display = 'block';
        return;
    }
    
    document.getElementById('emptyState').style.display = 'none';
    
    tbody.innerHTML = shelves.map(shelf => 
        '<tr>' +
            '<td><strong>' + shelf.shelf_code + '</strong></td>' +
            '<td>' + shelf.shelf_name + '</td>' +
            '<td><span class="zone-badge zone-' + shelf.zone + '">' + shelf.zone + '</span></td>' +
            '<td>Koridor ' + shelf.aisle + ', Seviye ' + shelf.level + '</td>' +
            '<td>' + shelf.capacity + '</td>' +
            '<td>' +
                '<div class="action-buttons">' +
                    '<button onclick="printShelfBarcode(\'' + shelf.shelf_code + '\')" class="btn btn-primary btn-sm">üñ®Ô∏è Barkod</button> ' +
                    '<button onclick="deleteShelf(' + shelf.id + ')" class="btn btn-secondary btn-sm">üóëÔ∏è Sil</button>' +
                '</div>' +
            '</td>' +
        '</tr>'
    ).join('');
}

async function saveShelf(e) {
    e.preventDefault();
    
    const formData = new FormData(e.target);
    const shelfData = Object.fromEntries(formData.entries());
    
    // Handle manual mode data
    if (isManualMode) {
        shelfData.zone = document.getElementById('manualZone').value.trim().toUpperCase();
        shelfData.aisle = document.getElementById('manualAisle').value.trim().toUpperCase();
        shelfData.level = document.getElementById('manualLevel').value.trim().toUpperCase();
    } else {
        shelfData.level = parseInt(shelfData.level);
    }
    
    shelfData.capacity = parseInt(shelfData.capacity);
    
    if (!shelfData.shelf_code) {
        showError('Raf barkodu olu≈üturulamadƒ±. L√ºtfen t√ºm alanlarƒ± doldurun.');
        return;
    }
    
    if (!shelfData.zone || !shelfData.aisle || !shelfData.level) {
        showError('B√∂lge, koridor ve seviye bilgileri gerekli.');
        return;
    }
    
    try {
        const submitBtn = e.target.querySelector('button[type="submit"]');
        submitBtn.disabled = true;
        submitBtn.textContent = 'üíæ Kaydediliyor...';
        
        const response = await fetch('/api/shelves', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(shelfData)
        });
        
        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error);
        }
        
        showSuccess('Raf ba≈üarƒ±yla kaydedildi!');
        clearForm();
        await loadShelves();
        
        if (confirm('Raf kaydedildi! Barkod etiketi yazdƒ±rmak ister misiniz?')) {
            await printShelfBarcode(data.shelf.shelf_code);
        }
        
    } catch (error) {
        console.error('Raf kaydetme hatasƒ±:', error);
        showError('Raf kaydedilemedi: ' + error.message);
    } finally {
        const submitBtn = document.getElementById('shelfForm').querySelector('button[type="submit"]');
        submitBtn.disabled = false;
        submitBtn.textContent = 'üíæ Rafƒ± Kaydet';
    }
}

async function deleteShelf(shelfId) {
    const shelf = allShelves.find(s => s.id === shelfId);
    if (!shelf) return;
    
    if (!confirm('Bu rafƒ± silmek istediƒüinizden emin misiniz?\\n\\nRaf: ' + shelf.shelf_code + '\\n' + shelf.shelf_name)) {
        return;
    }
    
    try {
        const response = await fetch('/api/shelves/' + shelfId, {
            method: 'DELETE'
        });
        
        const data = await response.json();
        
        if (!response.ok) {
            throw new Error(data.error);
        }
        
        showSuccess(data.message);
        await loadShelves();
        
    } catch (error) {
        console.error('Raf silme hatasƒ±:', error);
        showError('Raf silinemedi: ' + error.message);
    }
}

async function printShelfBarcode(shelfCode) {
    let shelf = allShelves.find(s => s.shelf_code === shelfCode);
    
    if (!shelf) {
        try {
            const response = await fetch('/api/shelves');
            const data = await response.json();
            allShelves = data.shelves || [];
            shelf = allShelves.find(s => s.shelf_code === shelfCode);
        } catch (error) {
            console.error('Raf bilgisi y√ºklenemedi:', error);
        }
    }
    
    if (!shelf) {
        showError('Raf bulunamadƒ±: ' + shelfCode);
        return;
    }
    
    console.log('Yazdƒ±rƒ±lacak raf:', shelf);
    
    const printWindow = window.open('', '_blank');
    if (!printWindow) {
        showError('Pop-up engelleyici aktif! L√ºtfen pop-up engellemeyi kapatƒ±n.');
        return;
    }
    
    const code = shelf.shelf_code || 'UNDEFINED';
    const name = shelf.shelf_name || 'Raf Adƒ± Belirtilmemi≈ü';
    const zone = shelf.zone || '?';
    const aisle = shelf.aisle || '?';
    const level = shelf.level || '?';
    const capacity = shelf.capacity || 100;
    const date = new Date().toLocaleDateString('tr-TR');
    
    const printHTML = '<!DOCTYPE html><html><head><title>Barkod Etiketi</title>' +
        '<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></' + 'script>' +
        '<style>' +
        'body{font-family:Arial;margin:20px;text-align:center;background:white;}' +
        '.label{width:10cm;height:6cm;border:2px solid #000;padding:20px;margin:auto;display:flex;flex-direction:column;justify-content:center;align-items:center;background:white;}' +
        '.header{font-size:16px;font-weight:bold;margin-bottom:10px;color:#333;}' +
        '.code{font-size:20px;font-weight:bold;margin:8px 0;font-family:monospace;letter-spacing:1px;}' +
        '.name{font-size:13px;margin:6px 0;font-weight:600;max-width:8cm;word-wrap:break-word;}' +
        '.info{font-size:11px;color:#666;margin:3px 0;}' +
        '#barcode{margin:10px 0;}' +
        '@media print{body{margin:0;}.label{margin:0;border:1px solid #000;}}' +
        '</style></head><body>' +
        '<div class="label">' +
        '<div class="header">WMS RAF ETƒ∞KETƒ∞</div>' +
        '<div class="code">' + code + '</div>' +
        '<svg id="barcode"></svg>' +
        '<div class="name">' + name + '</div>' +
        '<div class="info">' + zone + ' B√∂lgesi - Koridor ' + aisle + ' - Seviye ' + level + '</div>' +
        '<div class="info">Kapasite: ' + capacity + ' - ' + date + '</div>' +
        '</div>' +
        '<script>' +
        'setTimeout(function(){' +
        'try{' +
        'JsBarcode("#barcode", "' + code + '", {' +
        'format: "CODE128",' +
        'width: 2,' +
        'height: 40,' +
        'displayValue: false,' +
        'margin: 0' +
        '});' +
        'setTimeout(function(){window.print();}, 1000);' +
        '}catch(e){' +
        'console.error("Barkod olu≈üturma hatasƒ±:", e);' +
        'window.print();' +
        '}' +
        '}, 500);' +
        '</' + 'script>' +
        '</body></html>';
    
    try {
        printWindow.document.write(printHTML);
        printWindow.document.close();
    } catch (error) {
        console.error('Barkod etiketi olu≈üturma hatasƒ±:', error);
        showError('Barkod etiketi olu≈üturulamadƒ±: ' + error.message);
    }
}

function switchInputMode(manual) {
    isManualMode = manual;
    
    const selectMode = document.getElementById('selectMode');
    const manualModeBtn = document.getElementById('manualMode');
    const selectionInputs = document.getElementById('selectionInputs');
    const manualInputs = document.getElementById('manualInputs');
    
    if (manual) {
        selectMode.classList.remove('active');
        manualModeBtn.classList.add('active');
        selectionInputs.style.display = 'none';
        manualInputs.style.display = 'grid';
        
        // Clear selection inputs and disable required
        document.getElementById('zone').removeAttribute('required');
        document.getElementById('aisle').removeAttribute('required');
        document.getElementById('level').removeAttribute('required');
        
        // Enable manual inputs required
        document.getElementById('manualZone').setAttribute('required', 'true');
        document.getElementById('manualAisle').setAttribute('required', 'true');
        document.getElementById('manualLevel').setAttribute('required', 'true');
    } else {
        selectMode.classList.add('active');
        manualModeBtn.classList.remove('active');
        selectionInputs.style.display = 'grid';
        manualInputs.style.display = 'none';
        
        // Enable selection inputs required
        document.getElementById('zone').setAttribute('required', 'true');
        document.getElementById('aisle').setAttribute('required', 'true');
        document.getElementById('level').setAttribute('required', 'true');
        
        // Clear manual inputs and disable required
        document.getElementById('manualZone').removeAttribute('required');
        document.getElementById('manualAisle').removeAttribute('required');
        document.getElementById('manualLevel').removeAttribute('required');
    }
    
    generateBarcode();
}

function handleManualInput() {
    if (isManualMode) {
        generateBarcode();
    }
}

function handleCustomOption(event) {
    const select = event.target;
    if (select.value === 'CUSTOM') {
        const customValue = prompt(select.previousElementSibling.textContent.replace('*', '').trim() + ' i√ßin √∂zel deƒüer girin:');
        if (customValue && customValue.trim()) {
            // Add new option
            const newOption = document.createElement('option');
            newOption.value = customValue.trim().toUpperCase();
            newOption.textContent = customValue.trim();
            newOption.selected = true;
            
            // Insert before CUSTOM option
            const customOption = Array.from(select.options).find(opt => opt.value === 'CUSTOM');
            select.insertBefore(newOption, customOption);
        } else {
            select.value = '';
        }
        generateBarcode();
    }
}

function toggleManualBarcode() {
    const barcodeInput = document.getElementById('generatedBarcode');
    const toggleBtn = document.getElementById('manualBarcodeToggle');
    
    isManualBarcode = !isManualBarcode;
    
    if (isManualBarcode) {
        barcodeInput.removeAttribute('readonly');
        barcodeInput.placeholder = 'Barkod kodunu manuel girin...';
        barcodeInput.style.background = '#fff3cd';
        toggleBtn.textContent = 'üîí Otomatik';
        toggleBtn.title = 'Otomatik moda ge√ß';
    } else {
        barcodeInput.setAttribute('readonly', 'true');
        barcodeInput.placeholder = 'Otomatik olu≈üturulacak';
        barcodeInput.style.background = '';
        toggleBtn.textContent = '‚úèÔ∏è Manuel';
        toggleBtn.title = 'Manuel moda ge√ß';
        generateBarcode();
    }
}

function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

function showError(message) {
    alert('‚ùå Hata: ' + message);
}

function showSuccess(message) {
    alert('‚úÖ ' + message);
}

// Global scope'a fonksiyonlarƒ± ekle
window.regenerateBarcode = regenerateBarcode;
window.toggleManualBarcode = toggleManualBarcode;
window.clearForm = clearForm;
window.printShelfBarcode = printShelfBarcode;
window.deleteShelf = deleteShelf;
</script>

<style>
/* Modern Form Styles */
.user-friendly-form {
  background: linear-gradient(135deg, #f8fafc 0%, #ffffff 100%);
  border: 1px solid #e2e8f0;
  border-radius: 16px;
  overflow: hidden;
  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

.form-header {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 24px;
  text-align: center;
}

.form-header h2 {
  margin: 0 0 8px 0;
  font-size: 24px;
  font-weight: 600;
}

.form-description {
  margin: 0;
  opacity: 0.9;
  font-size: 14px;
}

.form-container {
  padding: 24px;
}

.form-section {
  margin-bottom: 32px;
}

.form-section:last-child {
  margin-bottom: 0;
}

.section-title {
  display: flex;
  align-items: center;
  gap: 8px;
  margin: 0 0 16px 0;
  color: #374151;
  font-size: 16px;
  font-weight: 600;
  padding-bottom: 8px;
  border-bottom: 2px solid #e5e7eb;
}

.form-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-bottom: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

.form-group.full-width {
  grid-column: 1 / -1;
}

.form-group label {
  display: flex;
  align-items: center;
  gap: 8px;
  font-weight: 600;
  color: #374151;
  margin-bottom: 8px;
  font-size: 14px;
}

.label-icon {
  font-size: 16px;
}

.modern-input, .modern-select {
  padding: 12px 16px;
  border: 2px solid #e5e7eb;
  border-radius: 8px;
  font-size: 14px;
  transition: all 0.2s ease;
  background: white;
  color: #1f2937;
  font-weight: 500;
}

.modern-input:focus, .modern-select:focus {
  outline: none;
  border-color: #667eea;
  box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.modern-input::placeholder {
  color: #9ca3af;
  font-weight: 400;
}

.modern-input:disabled, .modern-select:disabled {
  background: #f9fafb;
  color: #6b7280;
  cursor: not-allowed;
}

.help-text {
  color: #6b7280;
  font-size: 12px;
  margin-top: 4px;
}

/* Input Mode Toggle */
.input-mode-toggle {
  display: flex;
  background: #f3f4f6;
  border-radius: 8px;
  padding: 4px;
  margin-bottom: 20px;
  width: fit-content;
}

.toggle-btn {
  padding: 8px 16px;
  border: none;
  background: transparent;
  color: #6b7280;
  font-weight: 500;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease;
  font-size: 14px;
}

.toggle-btn.active {
  background: white;
  color: #667eea;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.selection-inputs, .manual-inputs {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
}

/* Barcode Container */
.barcode-container {
  display: flex;
  gap: 8px;
  align-items: flex-start;
}

.barcode-input {
  flex: 1;
  font-family: 'Courier New', monospace;
  font-weight: bold;
}

.barcode-actions {
  display: flex;
  gap: 4px;
  flex-direction: column;
}

.btn.btn-outline {
  padding: 6px 12px;
  border: 2px solid #e5e7eb;
  background: white;
  color: #374151;
  border-radius: 6px;
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
}

.btn.btn-outline:hover {
  border-color: #667eea;
  color: #667eea;
}

/* Modern Actions */
.modern-actions {
  background: #f8fafc;
  margin: 0 -24px -24px -24px;
  padding: 20px 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-top: 1px solid #e5e7eb;
}

.btn.btn-primary {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
}

.btn.btn-primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 8px rgba(102, 126, 234, 0.3);
}

.btn.btn-secondary {
  background: white;
  color: #6b7280;
  border: 2px solid #e5e7eb;
  padding: 12px 24px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
}

.btn.btn-secondary:hover {
  border-color: #9ca3af;
  color: #374151;
}

/* Responsive Design */
@media (max-width: 768px) {
  .form-row {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  
  .selection-inputs, .manual-inputs {
    grid-template-columns: 1fr;
    gap: 16px;
  }
  
  .barcode-container {
    flex-direction: column;
    align-items: stretch;
  }
  
  .barcode-actions {
    flex-direction: row;
    justify-content: center;
  }
  
  .modern-actions {
    flex-direction: column;
    gap: 12px;
    align-items: stretch;
  }
}

/* Error States */
.modern-input.error, .modern-select.error {
  border-color: #ef4444;
}

.modern-input.error:focus, .modern-select.error:focus {
  border-color: #ef4444;
  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.1);
}

/* Success States */
.modern-input.success, .modern-select.success {
  border-color: #10b981;
}

/* Barcode Preview */
.barcode-preview {
  margin-top: 8px;
  padding: 8px;
  background: #f8fafc;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 12px;
  color: #6b7280;
  text-align: center;
}
</style>

</body>
</html>