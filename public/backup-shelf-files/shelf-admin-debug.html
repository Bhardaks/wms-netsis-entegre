<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <title>Raf YÃ¶netimi - Debug</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .debug { background: #f0f0f0; padding: 10px; margin: 10px 0; border-radius: 5px; }
    .error { background: #ffebee; color: #c62828; padding: 10px; margin: 10px 0; border-radius: 5px; }
    .success { background: #e8f5e8; color: #2e7d32; padding: 10px; margin: 10px 0; border-radius: 5px; }
  </style>
</head>
<body>

<h1>ğŸ”§ Raf YÃ¶netimi - Debug Modu</h1>

<div class="debug">
  <strong>Debug Log:</strong>
  <div id="debugLog"></div>
</div>

<div>
  <h2>Test ButonlarÄ±:</h2>
  <button onclick="testBasicJS()">Temel JS Test</button>
  <button onclick="testAPICall()">API Test</button>
  <button onclick="testPrintFunction()">Print Fonksiyon Test</button>
</div>

<div id="results"></div>

<script>
function log(message) {
  const debugLog = document.getElementById('debugLog');
  debugLog.innerHTML += '<br>' + new Date().toLocaleTimeString() + ': ' + message;
  console.log(message);
}

function testBasicJS() {
  try {
    log('âœ… Temel JavaScript Ã§alÄ±ÅŸÄ±yor');
    document.getElementById('results').innerHTML = '<div class="success">JavaScript Ã§alÄ±ÅŸÄ±yor!</div>';
  } catch (error) {
    log('âŒ JavaScript hatasÄ±: ' + error.message);
    document.getElementById('results').innerHTML = '<div class="error">JavaScript hatasÄ±: ' + error.message + '</div>';
  }
}

async function testAPICall() {
  try {
    log('ğŸ”„ API testi baÅŸlÄ±yor...');
    const response = await fetch('/api/shelves');
    const data = await response.json();
    log('âœ… API Ã§alÄ±ÅŸÄ±yor, ' + (data.shelves ? data.shelves.length : 0) + ' raf var');
    document.getElementById('results').innerHTML = '<div class="success">API Ã§alÄ±ÅŸÄ±yor! Raf sayÄ±sÄ±: ' + (data.shelves ? data.shelves.length : 0) + '</div>';
  } catch (error) {
    log('âŒ API hatasÄ±: ' + error.message);
    document.getElementById('results').innerHTML = '<div class="error">API hatasÄ±: ' + error.message + '</div>';
  }
}

function testPrintFunction() {
  try {
    log('ğŸ”„ Print fonksiyon testi...');
    
    // Basit print testi - template literal kullanmadan
    const testWindow = window.open('', '_blank');
    const html = '<html><head><title>Test</title></head><body><h1>Print Test</h1><script>setTimeout(function(){window.close();}, 2000);</script></body></html>';
    testWindow.document.write(html);
    testWindow.document.close();
    
    log('âœ… Print fonksiyonu Ã§alÄ±ÅŸÄ±yor');
    document.getElementById('results').innerHTML = '<div class="success">Print fonksiyonu Ã§alÄ±ÅŸtÄ± (2 saniye sonra kapanacak)</div>';
  } catch (error) {
    log('âŒ Print hatasÄ±: ' + error.message);
    document.getElementById('results').innerHTML = '<div class="error">Print hatasÄ±: ' + error.message + '</div>';
  }
}

// Sayfa yÃ¼klendiÄŸinde
document.addEventListener('DOMContentLoaded', function() {
  log('ğŸ“„ Sayfa yÃ¼klendi');
  
  // Varsa hatalarÄ± yakala
  window.addEventListener('error', function(e) {
    log('ğŸš¨ Global hata: ' + e.message + ' (SatÄ±r: ' + e.lineno + ')');
  });
  
  // Unhandled promise rejection
  window.addEventListener('unhandledrejection', function(e) {
    log('ğŸš¨ Promise hatasÄ±: ' + e.reason);
  });
});
</script>

</body>
</html>